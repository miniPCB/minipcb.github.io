<!DOCTYPE html>

<html lang="en">
<head>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-9ZM2D6XGT2">
</script>
<script>
   window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-9ZM2D6XGT2');
  </script>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>
   Engineering Build Log – miniPCB™
  </title>
<link href="styles.css" rel="stylesheet"/>
<link href="favicon.png" rel="icon" type="image/png"/>
<meta content="miniPCB, Engineering Build Log, PCB Design, Hardware Engineering, Electronic Components, Change Management, Circuit Board, Change Log, Engineering Updates, PCB Updates, Product Engineering, PCB Engineering, Change Control, Engineering Control, Design Modifications, PCB Modifications, Engineering Change Notice, Miniature PCB, Electronics Engineering, PCB Change Log" name="keywords"/>
</head>
<body>
<nav>
<div class="nav-container">
<ul class="nav-links">
<li>
<a href="index.html">
       Home
      </a>
</li>
</ul>
</div>
</nav>
<main class="container">
<h1>Engineering Build Log</h1>
<p>This log documents engineering builds of miniPCB™ circuit boards.</p>
<table class="changelog-table" id="ebl-table">
<thead>
<tr>
<th>Date</th>
<th>Board</th>
<th>Rev</th>
<th>Title</th>
</tr>
</thead>
<tbody>
<!-- rows will be inserted here dynamically -->
</tbody>
</table>
</main>
<footer>
   © 2025 miniPCB. All rights reserved.
  </footer>
<button id="backToTop" onclick="scrollToTop()" title="Back to Top">
   ↑
  </button>
<script>
  document.addEventListener("DOMContentLoaded", renderEBL);

  async function renderEBL() {
    const tbody = document.querySelector("#ebl-table tbody");
    if (!tbody) return;

    try {
      const res = await fetch("EBL.json", { cache: "no-store" });
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const data = await res.json();

      if (!Array.isArray(data) || data.length === 0) {
        tbody.innerHTML = `<tr><td colspan="4">No builds logged yet.</td></tr>`;
        return;
      }

      // Newest first (supports EBL.build_date and legacy ECL.date)
      const items = data.slice().sort((a, b) => {
        const ad = Date.parse(a.build_date || a.date || "");
        const bd = Date.parse(b.build_date || b.date || "");
        return (isNaN(bd) ? 0 : bd) - (isNaN(ad) ? 0 : ad);
      });

      const frag = document.createDocumentFragment();
      items.forEach(entry => {
        const date  = entry.build_date ?? entry.date ?? "";
        const board = entry.board ?? "";
        const rev   = entry.rev ?? "";
        const title = entry.title ?? entry.change ?? "";
        const link  = entry.link ?? "";

        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${escapeHTML(date)}</td>
          <td>${escapeHTML(board)}</td>
          <td>${escapeHTML(rev)}</td>
          <td>${link ? `<a href="${encodeURI(link)}">${escapeHTML(title)}</a>` : escapeHTML(title)}</td>
        `;
        frag.appendChild(tr);
      });

      tbody.innerHTML = "";
      tbody.appendChild(frag);
    } catch (err) {
      console.error("Failed to load EBL.json:", err);
      const msg = document.createElement("tr");
      msg.innerHTML = `<td colspan="4">Failed to load build log.</td>`;
      tbody.innerHTML = "";
      tbody.appendChild(msg);
    }
  }

  function escapeHTML(s) {
    return String(s ?? "").replace(/[&<>"']/g, c => ({
      "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"
    }[c]));
  }
</script>

<script>
   function scrollToTop() {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  window.onscroll = function () {
    const btn = document.getElementById("backToTop");
    if (document.body.scrollTop > 400 || document.documentElement.scrollTop > 400) {
      btn.style.display = "block";
    } else {
      btn.style.display = "none";
    }
  };
  </script>
</body>
</html>
